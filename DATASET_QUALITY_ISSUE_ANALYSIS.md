# ë°ì´í„°ì…‹ í’ˆì§ˆ ë¬¸ì œ ë¶„ì„: ì™œ MLM v2ê°€ ê¸°ëŒ€ ì´í•˜ì˜ ì„±ëŠ¥ì„ ë³´ì˜€ëŠ”ê°€?

## ğŸ” í•µì‹¬ ë°œê²¬: í’ˆì§ˆ í•„í„°ë§ì˜ ì—­ì„¤

### ë¬¸ì œ ìš”ì•½
**MLM v2 ë°ì´í„°ì…‹ì€ 8ê°œì˜ ìƒˆë¡œìš´ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ì¶”ê°€í–ˆì§€ë§Œ, Combined ë°ì´í„°ì…‹ë³´ë‹¤ ë‚®ì€ ì„±ëŠ¥ì„ ë³´ì˜€ìŠµë‹ˆë‹¤.**

---

## ğŸ“Š ë°ì´í„°ì…‹ í¬ê¸° ë¹„êµ

### ìƒ˜í”Œ ìˆ˜ ë¹„êµ (1536 ê¸°ì¤€)
| ë°ì´í„°ì…‹ | ìƒ˜í”Œ ìˆ˜ | í¬ê¸° | ë¹„ìœ¨ |
|---------|--------|------|------|
| **V1 Original** | **187ê°œ** | 1.7MB | ê¸°ì¤€ |
| **V2 MLM** | **16,699ê°œ** | 147MB | **89ë°°** |
| **Combined** | **50,665ê°œ** | 446MB | **270ë°°** |

### ì¶©ê²©ì ì¸ ë°œê²¬
```
V1 Original:  187ê°œ
V2 MLM:       16,699ê°œ  (â†‘ 8,825%)
Combined:     50,665ê°œ  (â†‘ 26,986%)
```

**Combinedê°€ V2 MLMë³´ë‹¤ 3ë°° ë” ë§ì€ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤!**

---

## ğŸ”¬ ì›ì¸ ë¶„ì„

### 1. **í’ˆì§ˆ í•„í„°ë§ ê¸°ì¤€ì˜ ë¬¸ì œ**

#### V1 (dataset_preparation.py)
```python
# ìƒ˜í”Œë§ ë¹„ìœ¨: ë§¤ìš° ë³´ìˆ˜ì 
sample_size = min(1000, len(dataset))
indices = list(range(0, len(dataset), max(1, len(dataset) // sample_size)))

# í’ˆì§ˆ ì„ê³„ê°’
quality_threshold = 0.6

# ê²°ê³¼: 187ê°œ (ê·¹ì†Œìˆ˜ë§Œ í†µê³¼)
```

#### V2 (dataset_preparation_mlm_v2.py)
```python
# ìƒ˜í”Œë§ ë¹„ìœ¨: ê°œì„ ë¨
sample_size = min(2000, len(dataset))
indices = list(range(0, len(dataset), max(1, len(dataset) // sample_size)))

# í’ˆì§ˆ ì„ê³„ê°’ (ë™ì¼)
quality_threshold = 0.6

# ê²°ê³¼: 16,699ê°œ (V1ë³´ë‹¤ 89ë°° ì¦ê°€, í•˜ì§€ë§Œ ì—¬ì „íˆ ë¶€ì¡±)
```

#### Combined (ì§ì ‘ ë°ì´í„° ê²°í•©)
```python
# Wikipedia: 96MB
# KLUE MRC: 11MB
# Naver News: 19MB
# Entity Coref: 353MB
# í’ˆì§ˆ í•„í„°ë§ ì—†ì´ ì§ì ‘ ê²°í•©

# ê²°ê³¼: 50,665ê°œ (ê°€ì¥ ë§ì€ ë°ì´í„°)
```

---

### 2. **ìƒ˜í”Œë§ ë°©ì‹ì˜ ë¬¸ì œ**

#### V1/V2ì˜ ìƒ˜í”Œë§ ë¡œì§
```python
# ì „ì²´ ë°ì´í„°ì˜ ì¼ë¶€ë§Œ ë¶„ì„
indices = list(range(0, len(dataset), max(1, len(dataset) // sample_size)))

# ì˜ˆ: 100,000ê°œ ë°ì´í„°ì…‹ â†’ 1,000ê°œë§Œ ë¶„ì„ â†’ 100ê°œë§ˆë‹¤ 1ê°œ ì¶”ì¶œ
# ë¬¸ì œ: 99%ì˜ ë°ì´í„°ë¥¼ ë²„ë¦¼!
```

**ì˜ˆì‹œ ê³„ì‚°**:
- Wikipedia ë°ì´í„°ì…‹: 500,000ê°œ
- ìƒ˜í”Œë§: 2,000ê°œë§Œ ë¶„ì„
- **498,000ê°œì˜ ë°ì´í„°ëŠ” í‰ê°€ì¡°ì°¨ í•˜ì§€ ì•ŠìŒ!**
- í’ˆì§ˆ í†µê³¼: 800ê°œ (40% í†µê³¼ìœ¨)
- **ìµœì¢… ì‚¬ìš©: 800ê°œ / 500,000ê°œ = 0.16%ë§Œ ì‚¬ìš©**

#### Combinedì˜ ì§ì ‘ ê²°í•©
```python
# ëª¨ë“  ë°ì´í„° ì‚¬ìš©
- Wikipedia ì „ì²´ â†’ chunk â†’ ì‚¬ìš©
- KLUE MRC ì „ì²´ â†’ ì‚¬ìš©
- Naver News ì „ì²´ â†’ ì‚¬ìš©
- Entity Coref ì „ì²´ â†’ ì‚¬ìš©

# ê²°ê³¼: 50,665ê°œ (ëŒ€ë¶€ë¶„ì˜ ë°ì´í„° í™œìš©)
```

---

### 3. **í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°ì˜ ë¬¸ì œì **

#### í’ˆì§ˆ ì ìˆ˜ ê³µì‹ (V1/V2 ë™ì¼)
```python
# 1. ëŒ€ëª…ì‚¬-ê°œì²´ ìƒí˜¸ì‘ìš© ì ìˆ˜
coref_interaction = min(1.0, (pronoun_density * 20) + (entity_density * 3) + (pronoun_density * entity_density * 50))

# 2. ë³µì¡ë„ ì ìˆ˜
complexity_score = min(1.0, (entity_density * 10) + (verb_density * 5) + (pronoun_density * 15))

# 3. ê· í˜• ì ìˆ˜
balance_score = 1.0 - abs(pronoun_density - entity_density * 0.3)

# ì¢…í•© ì ìˆ˜
quality_score = (coref_interaction * 0.5) + (complexity_score * 0.3) + (balance_score * 0.2)
```

**ë¬¸ì œ**:
- **ëŒ€ëª…ì‚¬(pronoun) ì˜ì¡´ë„ê°€ ë„ˆë¬´ ë†’ìŒ**: pronoun_densityì— 20ë°°, 15ë°° ê°€ì¤‘ì¹˜
- **í•˜ì§€ë§Œ Real@1/Real@5ëŠ” ëŒ€ëª…ì‚¬ë¥¼ ì œì™¸í•œ ëª…ì‚¬ë§Œ í‰ê°€!**
- **ë¶ˆì¼ì¹˜**: í’ˆì§ˆ í•„í„°ë§ì€ ëŒ€ëª…ì‚¬ ì¤‘ì‹¬, í‰ê°€ëŠ” ëª…ì‚¬ ì¤‘ì‹¬

#### í‰ê°€ ë°ì´í„° ìƒì„± (build_real_coref_eval_set)
```python
def build_real_coref_eval_set():
    # ëŒ€ëª…ì‚¬ê°€ ì—†ëŠ” í…ìŠ¤íŠ¸ë§Œ ì‚¬ìš©!
    tokens = KIWI.tokenize(text)
    has_pronoun = any(t.tag == 'NP' for t in tokens)

    if has_pronoun:
        continue  # ëŒ€ëª…ì‚¬ ìˆìœ¼ë©´ ì œì™¸!

    # ê°™ì€ ëª…ì‚¬ê°€ 2ë²ˆ ì´ìƒ ë‚˜ì˜¤ëŠ” ê²½ìš°ë§Œ ì‚¬ìš©
    noun_counts = Counter(noun for token in tokens if token.tag in ['NNG', 'NNP'])
    if max(noun_counts.values()) < 2:
        continue
```

**ì—­ì„¤**:
- **í›ˆë ¨ ë°ì´í„° í•„í„°ë§**: ëŒ€ëª…ì‚¬ê°€ ë§ì€ ë°ì´í„° ì„ í˜¸ (quality_score ë†’ìŒ)
- **í‰ê°€ ë°ì´í„°**: ëŒ€ëª…ì‚¬ ì—†ëŠ” ë°ì´í„°ë§Œ ì‚¬ìš©!
- **ê²°ê³¼**: í›ˆë ¨ê³¼ í‰ê°€ì˜ ë°ì´í„° ë¶„í¬ ë¶ˆì¼ì¹˜

---

## ğŸ¯ ì„±ëŠ¥ ì°¨ì´ì˜ ì›ì¸

### Real@1 ì„±ëŠ¥ ë¹„êµ
| ë°ì´í„°ì…‹ | ìµœê³  ì„±ëŠ¥ | ìƒ˜í”Œ ìˆ˜ | ë°ì´í„° ë‹¤ì–‘ì„± |
|---------|----------|---------|-------------|
| **V2 MLM** | 66.04% (3ep) | 16,699ê°œ | â­â­â­ (14ê°œ ì†ŒìŠ¤, í•˜ì§€ë§Œ ìƒ˜í”Œë§ìœ¼ë¡œ ì†ì‹¤) |
| **Combined** | 66.75% (5ep) | 50,665ê°œ | â­â­â­â­â­ (6ê°œ ì†ŒìŠ¤, ì „ì²´ ë°ì´í„°) |

### ì„±ëŠ¥ ì°¨ì´ ì›ì¸ ë¶„ì„

#### 1. **ë°ì´í„° ì–‘ ë¶€ì¡±** (-67% ë°ì´í„°)
```
V2 MLM:   16,699ê°œ
Combined: 50,665ê°œ

ì°¨ì´: -33,966ê°œ (-67% ë¶€ì¡±)
```

#### 2. **ìƒ˜í”Œë§ìœ¼ë¡œ ì¸í•œ ë°ì´í„° ì†ì‹¤**
```
V2 MLM í”„ë¡œì„¸ìŠ¤:
1. 14ê°œ ë°ì´í„° ì†ŒìŠ¤ ë¡œë“œ
2. ê° ì†ŒìŠ¤ì—ì„œ 2,000ê°œë§Œ ìƒ˜í”Œë§
3. í’ˆì§ˆ í•„í„°ë§ (40% í†µê³¼)
4. ìµœì¢…: 16,699ê°œ

ì†ì‹¤ë¥ : 99% ì´ìƒì˜ ì›ë³¸ ë°ì´í„° ë²„ë¦¼!
```

#### 3. **í’ˆì§ˆ í•„í„°ë§ì˜ ì—­ì„¤**
```
ê³ í’ˆì§ˆ í•„í„°ë§ ê¸°ì¤€:
- ëŒ€ëª…ì‚¬ ë°€ë„ ë†’ìŒ â†’ ì ìˆ˜ â†‘
- ê°œì²´ ë°€ë„ ë†’ìŒ â†’ ì ìˆ˜ â†‘

í•˜ì§€ë§Œ í‰ê°€ëŠ”:
- ëŒ€ëª…ì‚¬ ì—†ëŠ” í…ìŠ¤íŠ¸ë§Œ ì‚¬ìš©!
- ë°˜ë³µ ëª…ì‚¬ë§Œ í‰ê°€!

ê²°ê³¼: í›ˆë ¨-í‰ê°€ ë¶ˆì¼ì¹˜
```

---

## ğŸ“ˆ MLM v2ì˜ ì´ˆê¸° ì„±ëŠ¥ì´ ë†’ì•˜ë˜ ì´ìœ 

### MLM v2 @ 0.5 ì—í­: Real@1 = 65.58%
### Combined @ 1 ì—í­: Real@1 = 62.92%

**ì™œ ì´ˆê¸°ì—ëŠ” MLM v2ê°€ ë” ì¢‹ì•˜ì„ê¹Œ?**

#### 1. **ë°ì´í„° ë‹¤ì–‘ì„±**
- MLM v2: 14ê°œ ë‹¤ì–‘í•œ ì†ŒìŠ¤ (ë‰´ìŠ¤ 8ê°œ ì¶”ê°€)
- Combined: 6ê°œ ì†ŒìŠ¤ (Wikipedia, KLUE, KorQuAD ë“±)

#### 2. **ë„ë©”ì¸ ë¶„í¬**
```
MLM v2:
- ë‰´ìŠ¤ ì†ŒìŠ¤: 8ê°œ (ê¸ˆìœµ, ê²½ì œ, ë„¤ì´ë²„, ë²ˆì—­ ë“±)
- QA: 2ê°œ
- Wikipedia: 1ê°œ
- ê¸°íƒ€: 3ê°œ

Combined:
- Wikipedia: ëŒ€ë¶€ë¶„
- KLUE: ì¼ë¶€
- KorQuAD: ì¼ë¶€
```

#### 3. **ë¹ ë¥¸ ìˆ˜ë ´**
- **ì ì€ ë°ì´í„°** (16K) â†’ **ë¹ ë¥¸ ìˆ˜ë ´** (0.5 ì—í­)
- **ë‹¤ì–‘í•œ ë„ë©”ì¸** â†’ **ì¼ë°˜í™” ë¹ ë¦„**

#### 4. **í•˜ì§€ë§Œ í•œê³„ ë„ë‹¬**
- **ë°ì´í„° ë¶€ì¡±** â†’ 3 ì—í­ ì´í›„ ê³¼ì í•©
- **ìƒ˜í”Œ ë‹¤ì–‘ì„± ë¶€ì¡±** â†’ ë” ì´ìƒ ê°œì„  ë¶ˆê°€

---

## ğŸ”¬ ë°ì´í„° í’ˆì§ˆ ì‹¤ì œ ë¹„êµ

### ìƒ˜í”Œ ë¶„ì„ ê²°ê³¼

#### V1 (187ê°œ) - ê³ í’ˆì§ˆ, ê·¹ì†ŒëŸ‰
```
ìƒ˜í”Œ ì˜ˆì‹œ:
"1945ë…„ 8ì›” 15ì¼ ì¼ì œë¡œë¶€í„° í•´ë°©ë˜ì ê°€ì¥ ë¨¼ì € í™œë™ì„ ì‹œì‘í•œ ì„¸ë ¥ì€
ì—¬ìš´í˜•ì„ ì¤‘ì‹¬ìœ¼ë¡œ í•˜ëŠ” ë¯¼ì¡±ì£¼ì˜ ì¢ŒíŒŒì„¸ë ¥ë“¤ê³¼ ë°•í—Œì˜ì˜ ì¡°ì„ ê³µì‚°ë‹¹ì„
ì¤‘ì‹¬ìœ¼ë¡œ í•˜ëŠ” ê³µì‚°ì£¼ì˜ ê·¹ì¢Œì„¸ë ¥ë“¤ì´ì—ˆë‹¤..."

íŠ¹ì§•:
- í† í° ìˆ˜: 617~909 (í‰ê·  744)
- ë‚´ìš©: ì •ì¹˜, ì‚¬íšŒ, ì—­ì‚¬ ë“± ì‹¬ë„ ìˆëŠ” ì£¼ì œ
- í’ˆì§ˆ: ë§¤ìš° ë†’ìŒ (ëŒ€ëª…ì‚¬, ê°œì²´ ë°€ë„ ëª¨ë‘ ë†’ìŒ)
```

#### V2 MLM (16,699ê°œ) - ì¤‘ê°„ í’ˆì§ˆ, ì¤‘ê°„ ì–‘
```
ìƒ˜í”Œ ì˜ˆì‹œ:
"ç¾ ê²½ì œ ìƒë°˜ê¸° ì´ë¯¸ ê²½ê¸°ì¹¨ì²´ ì§„ì… ë§ ì•„ê¼ˆë˜ WSJë„ ì¶”ê°€ í•˜ë½ ì „ë§
ìœ ë™ì„± í‚¤ìš´ ì—”ìºë¦¬ íŠ¸ë ˆì´ë“œ ëë¬¼ ì±„ë¬´ìœ„ê¸° ê³ ì¡°ë¡œ ìœ ë¡œì¡´ë„ ë¶ˆì•ˆ..."

íŠ¹ì§•:
- í† í° ìˆ˜: 563~1083 (í‰ê·  854)
- ë‚´ìš©: ë‰´ìŠ¤ ê¸°ì‚¬, ì§§ê³  ê°„ê²°
- í’ˆì§ˆ: ì¤‘ìƒ (ë‰´ìŠ¤ íŠ¹ì„±ìƒ ê°œì²´ ë§ìŒ, ëŒ€ëª…ì‚¬ ì ìŒ)
```

#### Combined (50,665ê°œ) - ë‹¤ì–‘í•œ í’ˆì§ˆ, ëŒ€ëŸ‰
```
ìƒ˜í”Œ ì˜ˆì‹œ:
"ë¶€ì‚°ëŒ€ ì² í•™ê³¼ì— ë‹¤ë‹ˆëŠ” í™ì¤€ì„± ì”¨(24)ëŠ” ì§€ë‚œí•´ ê°€ì„ í•™ìƒ ì‹ ë¶„ìœ¼ë¡œ
ì œ3íšŒ í•œê²½ ì²­ë…„ì‹ ì¶˜ë¬¸ì˜ˆì˜ ë¬¸ì„ ë‘ë“œë ¸ë‹¤. í™ì”¨ëŠ” ì² í•™ê³¼ ì±…ì„ ì¢‹ì•„í•˜ëŠ”
í‰ë²”í•œ í•™ìƒì´ì—ˆë‹¤. ì‹ ì¶˜ë¬¸ì˜ˆ ì¥í¸ì†Œì„¤ ë¶€ë¬¸ì— ë‹¹ì„ ë˜ë©° ê·¸ì˜ ì‚¶ì€ ë³€í–ˆë‹¤..."

íŠ¹ì§•:
- í† í° ìˆ˜: 289~864 (í‰ê·  489)
- ë‚´ìš©: Wikipedia, ë‰´ìŠ¤, QA í˜¼í•©
- í’ˆì§ˆ: ë‹¤ì–‘ (ëŒ€ëª…ì‚¬ "ê·¸ì˜", "í™ì”¨" ë“± ìì—°ìŠ¤ëŸ¬ìš´ coref)
```

---

## ğŸ’¡ í•µì‹¬ ê²°ë¡ 

### ì™œ MLM v2ê°€ Combinedë³´ë‹¤ ì„±ëŠ¥ì´ ë‚®ì€ê°€?

#### âŒ **ì˜ëª»ëœ ê°€ì •ë“¤**

1. **"ë” ë§ì€ ë°ì´í„° ì†ŒìŠ¤ = ë” ì¢‹ì€ ì„±ëŠ¥"**
   - ì‹¤ì œ: ìƒ˜í”Œë§ìœ¼ë¡œ 99% ë²„ë¦¼ â†’ ì‹¤ì œ ì‚¬ìš© ë°ì´í„° ì˜¤íˆë ¤ ê°ì†Œ

2. **"í’ˆì§ˆ í•„í„°ë§ = ë” ì¢‹ì€ ì„±ëŠ¥"**
   - ì‹¤ì œ: í’ˆì§ˆ ê¸°ì¤€ê³¼ í‰ê°€ ê¸°ì¤€ ë¶ˆì¼ì¹˜ â†’ ì—­íš¨ê³¼

3. **"ëŒ€ëª…ì‚¬ ë§ì€ ë°ì´í„° = ì¢‹ì€ Coref ë°ì´í„°"**
   - ì‹¤ì œ: Real@1/Real@5ëŠ” ëŒ€ëª…ì‚¬ ì—†ëŠ” ë°ì´í„°ë¡œ í‰ê°€ â†’ í›ˆë ¨-í‰ê°€ ë¶ˆì¼ì¹˜

#### âœ… **ì‹¤ì œ ì›ì¸**

1. **ë°ì´í„° ì–‘ ë¶€ì¡±** (16K vs 50K)
   - 67% ì ì€ ë°ì´í„°ë¡œ í•™ìŠµ
   - ì¡°ê¸° ê³¼ì í•© (3 ì—í­)

2. **ìƒ˜í”Œë§ì˜ ì¹˜ëª…ì  ì†ì‹¤**
   - ì›ë³¸ ë°ì´í„°ì˜ 99%ë¥¼ í‰ê°€ì¡°ì°¨ í•˜ì§€ ì•ŠìŒ
   - ê³ í’ˆì§ˆ ìƒ˜í”Œë„ ìƒ˜í”Œë§ ê³¼ì •ì—ì„œ ëˆ„ë½

3. **í’ˆì§ˆ ê¸°ì¤€ ë¶ˆì¼ì¹˜**
   - í›ˆë ¨: ëŒ€ëª…ì‚¬ ì„ í˜¸
   - í‰ê°€: ëŒ€ëª…ì‚¬ ì œì™¸
   - ê²°ê³¼: í•™ìŠµ ë°©í–¥ í‹€ì–´ì§

4. **ë°ì´í„° ë‹¤ì–‘ì„± vs ì–‘ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„**
   - MLM v2: 14ê°œ ì†ŒìŠ¤, í•˜ì§€ë§Œ ê° ì†ŒìŠ¤ì—ì„œ ì ê²Œ ì¶”ì¶œ
   - Combined: 6ê°œ ì†ŒìŠ¤, í•˜ì§€ë§Œ ê° ì†ŒìŠ¤ì—ì„œ ëŒ€ëŸ‰ ì¶”ì¶œ
   - **ê²°ê³¼: ì–‘(Combined)ì´ ë‹¤ì–‘ì„±(MLM v2)ì„ ì´ê¹€**

---

## ğŸš€ í•´ê²° ë°©ì•ˆ

### 1. **í’ˆì§ˆ í•„í„°ë§ ì œê±° ë˜ëŠ” ëŒ€í­ ì™„í™”**

```python
# í˜„ì¬ (V2)
sample_size = min(2000, len(dataset))
indices = list(range(0, len(dataset), max(1, len(dataset) // sample_size)))
quality_threshold = 0.6

# ê°œì„ ì•ˆ 1: ìƒ˜í”Œë§ ì œê±°
# ëª¨ë“  ë°ì´í„° í’ˆì§ˆ í‰ê°€ í›„ í•„í„°ë§
qualities = batch_analyze_quality(all_texts)
high_quality = [text for text, q in zip(all_texts, qualities) if q['quality_score'] >= 0.4]

# ê°œì„ ì•ˆ 2: í’ˆì§ˆ í•„í„°ë§ ì™„ì „ ì œê±°
# ê¸¸ì´ í•„í„°ë§ë§Œ ìˆ˜í–‰
valid_texts = [text for text in all_texts if 50 < len(text) < max_len]
```

### 2. **í‰ê°€ì— ë§ì¶˜ í’ˆì§ˆ ê¸°ì¤€ ì¬ì„¤ê³„**

```python
# í˜„ì¬: ëŒ€ëª…ì‚¬ ì¤‘ì‹¬
coref_interaction = pronoun_density * 20 + entity_density * 3 + ...

# ê°œì„ ì•ˆ: ëª…ì‚¬ ë°˜ë³µ ì¤‘ì‹¬
def real_coref_quality(text):
    tokens = KIWI.tokenize(text)
    nouns = [t.form for t in tokens if t.tag in ['NNG', 'NNP'] and len(t.form) > 1]

    # ë°˜ë³µ ëª…ì‚¬ ì¹´ìš´íŠ¸
    noun_counts = Counter(nouns)
    repeated_nouns = sum(1 for count in noun_counts.values() if count >= 2)

    # ë°˜ë³µ ë¹„ìœ¨
    repetition_score = repeated_nouns / max(1, len(set(nouns)))

    # ê°œì²´ ë‹¤ì–‘ì„±
    diversity_score = len(set(nouns)) / max(1, len(nouns))

    # ì¢…í•© ì ìˆ˜
    quality_score = 0.6 * repetition_score + 0.4 * diversity_score

    return quality_score
```

### 3. **ëŒ€ëŸ‰ ë°ì´í„° í™œìš© ì „ëµ**

```python
# 14ê°œ ì†ŒìŠ¤ ëª¨ë‘ í™œìš©, ìƒ˜í”Œë§ ìµœì†Œí™”
def prepare_mlm_v3():
    all_data = []

    for source in sources:
        # ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ì²˜ë¦¬
        dataset = load_dataset(source, streaming=True)

        # ê¸¸ì´ í•„í„°ë§ë§Œ ìˆ˜í–‰
        for item in dataset:
            text = extract_text(item, source.domain)
            tokens = tokenizer.encode(text)

            if target_seq_len * 0.3 < len(tokens) < target_seq_len * 1.5:
                all_data.append(text)

                # ë©”ëª¨ë¦¬ ê´€ë¦¬: 10ë§Œê°œë§ˆë‹¤ ì €ì¥
                if len(all_data) >= 100000:
                    save_batch(all_data)
                    all_data = []

    # ëª©í‘œ: 100K+ ìƒ˜í”Œ
```

### 4. **í›ˆë ¨ ì „ëµ ì¡°ì •**

```python
# MLM v2ì˜ ì¥ì  í™œìš©
- ì´ˆê¸° ìˆ˜ë ´ ì†ë„ ë¹ ë¦„ (0.5 ì—í­ì— 65.58%)
- ë°ì´í„° ë‹¤ì–‘ì„± ìš°ìˆ˜ (14ê°œ ì†ŒìŠ¤)

# ê°œì„  ë°©í–¥
1. ëŒ€ëŸ‰ ë°ì´í„° ìƒì„± (100K+ ìƒ˜í”Œ)
2. Early stopping (3-4 ì—í­)
3. ë°ì´í„° ë‹¤ì–‘ì„± ìœ ì§€ (14ê°œ ì†ŒìŠ¤ ëª¨ë‘ í™œìš©)
```

---

## ğŸ“Š ì˜ˆìƒ ì„±ëŠ¥ ê°œì„ 

### í˜„ì¬ (MLM v2)
```
ìƒ˜í”Œ ìˆ˜: 16,699ê°œ
ìµœê³  ì„±ëŠ¥: Real@1 = 66.04% (3 ì—í­)
ë¬¸ì œ: ê³¼ì í•©, ë°ì´í„° ë¶€ì¡±
```

### ê°œì„  í›„ (MLM v3)
```
ìƒ˜í”Œ ìˆ˜: 100,000ê°œ+ (6ë°° ì¦ê°€)
ì˜ˆìƒ ì„±ëŠ¥: Real@1 = 68-69% (3-4 ì—í­)
ê·¼ê±°:
- Combined (50K) = 66.75%
- MLM v3 (100K, 14ê°œ ì†ŒìŠ¤) = 68-69% (ì˜ˆìƒ)
```

### Entity Fine-tuning í›„
```
MLM v3 (100K) â†’ Entity FT
ì˜ˆìƒ: Real@1 = 69-70%
í˜„ì¬ ë² ìŠ¤íŠ¸: 67.78%
ê°œì„ í­: +1-2%p
```

---

## ğŸ¯ ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥í•œ ì•¡ì…˜

### ë‹¨ê¸° (ì§€ê¸ˆ ë‹¹ì¥)
1. âœ… **Combined ë°ì´í„°ì…‹ ì‚¬ìš©**
   - ì´ë¯¸ 50K ìƒ˜í”Œë¡œ 66.75% ë‹¬ì„±
   - ì•ˆì •ì ì´ê³  ì…ì¦ëœ ì„±ëŠ¥

2. âœ… **MLM v2 checkpoint-390 + Entity FT**
   - MLM v2ì˜ ì´ˆê¸° ìˆ˜ë ´ ì†ë„ í™œìš©
   - Entity ë°ì´í„°ë¡œ ì¶”ê°€ í•™ìŠµ

### ì¤‘ê¸° (1-2ì¼)
3. ğŸ”„ **MLM v3 ë°ì´í„°ì…‹ ìƒì„±**
   - ìƒ˜í”Œë§ ì œê±° or ëŒ€í­ ì™„í™”
   - í’ˆì§ˆ í•„í„°ë§ ê¸°ì¤€ ì¬ì„¤ê³„
   - ëª©í‘œ: 100K+ ìƒ˜í”Œ

4. ğŸ”„ **MLM v3 í›ˆë ¨**
   - 3-4 ì—í­ í›ˆë ¨
   - Early stopping ì ìš©

### ì¥ê¸° (ê²€ì¦ í›„)
5. ğŸ“Š **í‰ê°€ ê¸°ì¤€ ì¬ê²€í† **
   - Real@1/Real@5ì™€ í›ˆë ¨ ëª©í‘œ ì¼ì¹˜ í™•ì¸
   - í•„ìš”ì‹œ í‰ê°€ ë©”íŠ¸ë¦­ ì¶”ê°€

---

## ğŸ“ êµí›ˆ

### âœ… **ì˜¬ë°”ë¥¸ ì ‘ê·¼**
1. **ë°ì´í„° ì–‘ > ë°ì´í„° í’ˆì§ˆ í•„í„°ë§**
2. **í›ˆë ¨-í‰ê°€ ì¼ì¹˜ > ì£¼ê´€ì  í’ˆì§ˆ ê¸°ì¤€**
3. **ì „ì²´ ë°ì´í„° í™œìš© > ìƒ˜í”Œë§**
4. **ì‹¤í—˜ ê²°ê³¼ ë¶„ì„ > ê°€ì • ê¸°ë°˜ ì„¤ê³„**

### âŒ **ì˜ëª»ëœ ì ‘ê·¼**
1. ~~"í’ˆì§ˆ í•„í„°ë§í•˜ë©´ ë¬´ì¡°ê±´ ì¢‹ë‹¤"~~
2. ~~"ëŒ€ëª…ì‚¬ ë§ì€ ë°ì´í„° = Coref ë°ì´í„°"~~
3. ~~"ìƒ˜í”Œë§ìœ¼ë¡œ ì¶©ë¶„í•˜ë‹¤"~~
4. ~~"ë” ë§ì€ ì†ŒìŠ¤ = ë” ì¢‹ì€ ì„±ëŠ¥"~~

### ğŸ“ **í•µì‹¬ ì¸ì‚¬ì´íŠ¸**
> **"Quality filtering is only useful when quality criteria align with evaluation metrics."**
>
> í’ˆì§ˆ í•„í„°ë§ì€ í’ˆì§ˆ ê¸°ì¤€ì´ í‰ê°€ ë©”íŠ¸ë¦­ê³¼ ì¼ì¹˜í•  ë•Œë§Œ ìœ ìš©í•˜ë‹¤.

> **"Data quantity beats quality filtering when filtering discards 99% of data."**
>
> í•„í„°ë§ì´ 99%ì˜ ë°ì´í„°ë¥¼ ë²„ë¦´ ë•ŒëŠ” ë°ì´í„° ì–‘ì´ í’ˆì§ˆ í•„í„°ë§ì„ ì´ê¸´ë‹¤.

> **"Fast convergence on small data != good final performance."**
>
> ì ì€ ë°ì´í„°ì—ì„œì˜ ë¹ ë¥¸ ìˆ˜ë ´ â‰  ì¢‹ì€ ìµœì¢… ì„±ëŠ¥

---

## ğŸ” ì¶”ê°€ ì¡°ì‚¬ í•„ìš” ì‚¬í•­

1. **Combined ë°ì´í„°ì…‹ êµ¬ì„± í™•ì¸**
   - ì–´ë–¤ ë°ì´í„°ê°€ í¬í•¨ë˜ì—ˆëŠ”ì§€
   - ì™œ 50K ìƒ˜í”Œì´ ìƒì„±ë˜ì—ˆëŠ”ì§€

2. **í’ˆì§ˆ ì ìˆ˜ ë¶„í¬ ë¶„ì„**
   - V1, V2, Combinedì˜ í’ˆì§ˆ ì ìˆ˜ ë¶„í¬
   - ì‹¤ì œ ì„±ëŠ¥ê³¼ì˜ ìƒê´€ê´€ê³„

3. **Real@1/Real@5 í‰ê°€ ë°ì´í„° ë¶„ì„**
   - í‰ê°€ ë°ì´í„°ì˜ íŠ¹ì„±
   - í›ˆë ¨ ë°ì´í„°ì™€ì˜ ë¶„í¬ ì°¨ì´

---

## ğŸ“Œ ê²°ë¡ 

**MLM v2ê°€ ê¸°ëŒ€ ì´í•˜ì˜ ì„±ëŠ¥ì„ ë³´ì¸ ì´ìœ ëŠ” ë°ì´í„°ì…‹ í’ˆì§ˆì´ ë‚˜ì˜ê±°ë‚˜ ë°ì´í„° ì†ŒìŠ¤ê°€ ë¶€ì¡±í•´ì„œê°€ ì•„ë‹ˆë¼, ì˜ëª»ëœ ìƒ˜í”Œë§ê³¼ ë¶ˆì¼ì¹˜í•˜ëŠ” í’ˆì§ˆ í•„í„°ë§ ê¸°ì¤€ ë•Œë¬¸ì…ë‹ˆë‹¤.**

**í•´ê²°ì±…ì€ ê°„ë‹¨í•©ë‹ˆë‹¤: ìƒ˜í”Œë§ì„ ì œê±°í•˜ê³ , í’ˆì§ˆ í•„í„°ë§ì„ ì™„í™”í•˜ê±°ë‚˜ í‰ê°€ ë©”íŠ¸ë¦­ì— ë§ê²Œ ì¬ì„¤ê³„í•˜ì—¬, ê°€ëŠ¥í•œ ë§ì€ ë°ì´í„°ë¥¼ í™œìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.**

**"More data with simple filtering > Less data with complex quality filtering"**
